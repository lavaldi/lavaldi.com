---
title: 'Generar un post a partir de un template con Hygen en Gatsby'
publishedAt: '2020-03-23'
tags:
  - hygen
  - gatsby
---

Desde que tengo mi blog en GitHub pages siempre he sufrido con generar el archivo markdown para empezar a escribir un post debido a que lo hacÃ­a manualmente, iba a la carpeta, creaba un nuevo archivo y me ponÃ­a a escribir la fecha y el nombre y luego en el archivo escribir todo el frontmatter que necesito para un post normal... ðŸ˜«ðŸ˜©ðŸ˜ª

AsÃ­ que hace poco me dispuse a buscar un modo de automatizar esta tarea y encontrÃ© [Hygen](http://www.hygen.io/) que, segÃºn su propia descripciÃ³n, es un generador de cÃ³digo que te permite ahorrar tiempo generando templates [ejs](https://ejs.co/) ðŸ˜ƒ

Esto es lo que haremos:

![Generar un post a partir de un template con Hygen](https://i.imgur.com/ocxaniF.gif)

Manos a la obra! ðŸ’ª

## InstalaciÃ³n

```shell
yarn add hygen # o npm i hygen
```

tambiÃ©n lo puedes usar con `npx` si gustas: `npx hygen ...`

## Crear tu generador de cÃ³digo

Primero debemos inicializar Hygen en nuestro proyecto:

```shell
cd your-project
hygen init self

Loaded templates: /usr/local/lib/node_modules/hygen/src/templates
       added: _templates/generator/help/index.ejs.t
       added: _templates/generator/with-prompt/hello.ejs.t
       added: _templates/generator/with-prompt/prompt.ejs.t
       added: _templates/generator/new/hello.ejs.t
```

Que nos crearÃ¡ unos archivos de ejemplo de generadores de cÃ³digo, los cuales podemos explorar con total libertad y luego eliminar o modificar si deseamos hacerlo.

```shell
_templates
â””â”€â”€ generator
    â”œâ”€â”€ help
    â”‚Â Â  â””â”€â”€ index.ejs.t
    â”œâ”€â”€ new
    â”‚Â Â  â””â”€â”€ hello.ejs.t
    â””â”€â”€ with-prompt
        â”œâ”€â”€ hello.ejs.t
        â””â”€â”€ prompt.ejs.t

6 directories, 5 files
```

## Construir nuestro generador de cÃ³digo

```shell
hygen generator new blog-post

Loaded templates: _templates
       added: _templates/blog-post/new/hello.ejs.t
```

Si abrimos el archivo `_templates/blog-post/new/hello.ejs.t` podremos observar el siguiente cÃ³digo de ejemplo:

````ejs
---
to: _templates/<%= name %>/<%= action || 'new' %>/hello.ejs.t
---
---
to: app/hello.js
---
const hello = ```
Hello!
This is your first hygen template.

Learn what it can do here:

https://github.com/jondot/hygen```

console.log(hello)
````

El cual vamos a modificar a continuaciÃ³n para crear nuestro template para un post de [Gatsby](https://www.gatsbyjs.org/)

### Creando nuestro template

Primero modificaremos el nombre del template `hello.ejs.t` a `index.ejs.t` de tal manera que nuestra estructura de carpetas quede asÃ­:

```shell
_templates
â””â”€â”€ blog-post
    â””â”€â”€ new
        â””â”€â”€ index.ejs.t

2 directories, 1 file
```

Luego, crearemos el archivo `.hygen.js` a travÃ©s del cual podremos extender la funcionalidad de Hygen, en nuestro caso, para poder agregar un par de helpers que nos ayudarÃ¡n a crear nuestro template. Si quieres saber mÃ¡s sobre la extensibilidad de Hygen puedes ir [aquÃ­](http://www.hygen.io/extensibility).

A continuaciÃ³n, instalaremos el paquete `@sindresorhus/slugify` que nos permitirÃ¡ convertir en un slug el tÃ­tulo de nuestro post.

```shell
yarn add @sindresorhus/slugify
```

Ahora pasamos a modificar el archivo `.hygen.js` de la siguiente manera:

```javascript
const slugify = require('@sindresorhus/slugify');

const date = [
  new Date().getFullYear(),
  ('0' + (new Date().getMonth() + 1)).slice(-2),
  ('0' + new Date().getDate()).slice(-2)
].join('-');

module.exports = {
  helpers: {
    date: (s) => date,
    slugify: (s) => slugify(s)
  }
};
```

Luego en el archivo `index.ejs.t` agregaremos el frontmatter, que necesita el template, para indicar la ruta donde serÃ¡ creado el archivo markdown para nuestro nuevo post y que sea creado Ãºnicamente si no existe:

```ejs
---
to: content/posts/<%= h.date() %>-<%= h.slugify(name) %>.md
unless_exists: true
---
```

Como vemos estamos indicando que el archivo se cree en la ruta `content/posts/` y el nombre sea `<%= h.date() %>-<%= h.slugify(name) %>.md`. Para el nombre estamos utilizando los helpers con los cuales extendimos Hygen en el archivo `.hygen.js`, `date` y `slugify`, que generarÃ¡n algo como esto `2020-03-23-titulo-de-mi-nuevo-post.md`.

A continuaciÃ³n irÃ¡ el contenido que queremos que vaya en nuestro archivo markdown. En mi caso es este:

```ejs
---
to: content/posts/<%= h.date() %>-<%= h.slugify(name) %>.md
unless_exists: true
---
---
title: "<%= h.inflection.humanize(name) %>"
date: <%= h.date() %>
categories:
  - category
tags:
  - tag
template: post
slug: "<%= h.slugify(name) %>"
---

The Post starts here
```

Para el tÃ­tulo estamos usando el helper `inflection` que nos brinda el propio Hygen que nos ayuda a manejar los textos. Para mÃ¡s informaciÃ³n sobre los Helpers e Inflections puedes ir [aquÃ­](http://www.hygen.io/templates/#helpers-and-inflections).

Y con eso estamos listos!

## Usando nuestro generador

Ahora podemos usar el generador de templates que hemos creado de la siguiente manera:

```shell
hygen blog-post new --name "TÃ­tulo de mi nuevo post"
```

ðŸŽ‰

## AgregÃ¡ndo nuestro generador a npm scripts:

Como somos fancies vamos a agregar el generador creado como un npm script. En nuestro `package.json` agregamos lo siguiente en la secciÃ³n de scripts:

```json
{
  ...
  "scripts": {
    "new:post": "hygen blog-post new --name",
    ...
  },
  ...
}
```

Y ahora lo podemos ejecutar con yarn:

```shell
yarn new:post "TÃ­tulo de mi nuevo post" # o npm run new:post -- "TÃ­tulo de mi nuevo post"
```

ðŸŽ‰ðŸŽ‰ðŸŽ‰
