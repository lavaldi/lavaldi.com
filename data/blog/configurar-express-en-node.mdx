---
title: '¬øC√≥mo configurar Express.js en Node.js?'
publishedAt: '2019-02-02'
tags:
  - node
  - babel
  - express
---

> Este tutorial es la parte 2 de 3 en esta serie.<br />
> Parte 1: [Configuraci√≥n m√≠nima de Node.js con Babel](/node-con-babel)<br />
> Parte 3: [C√≥mo crear un API REST con Express.js y Node.js](/como-crear-api-rest-express-node)

Express.js es la opci√≥n m√°s popular cuando se trata de crear aplicaciones web con Node.js. Express.js, es un framework de aplicaciones web para Node.js, te permite crear aplicaciones de servidor en Node.js. Como una aplicaci√≥n back-end, es el pegamento entre su aplicaci√≥n de front-end y una posible base de datos u otras fuentes de datos (API REST, API GraphQL, etc.).

Express.js es intercambiable con otros frameworks de aplicaciones web para el back-end de la misma manera que React.js es intercambiable con Vue.js y Angular.js cuando se trata de aplicaciones front-end. El ecosistema Node.js no ofrece solo una soluci√≥n, sino varias soluciones que vienen con sus fortalezas y debilidades. Sin embargo, para esta aplicaci√≥n usaremos un servidor Express, porque es la opci√≥n m√°s popular cuando se trata de crear aplicaciones de back-end de JavaScript con Node.js.

La aplicaci√≥n Node.js [del tutorial anterior](/node-con-babel) viene con una secuencia de comandos para reiniciar su aplicaci√≥n una vez que el c√≥digo fuente haya cambiado, Babel para habilitar las funciones de JavaScript que a√∫n no son compatibles con Node.js y las variables de entorno para la informaci√≥n sensible de tu aplicaci√≥n. Esa es una excelente base para comenzar a utilizar Express.js en Node.js. Continuemos instalando Express.js en la aplicaci√≥n Node.js desde la l√≠nea de comandos:

```bash
npm install express
```

Ahora, en tu archivo `src/index.js`, usa el siguiente c√≥digo para importar Express.js, para crear una instancia de una aplicaci√≥n Express y para iniciarla como servidor Express:

```javascript
import express from "express";

const app = express();

app.listen(3000, () =>
  console.log("¬°Aplicaci√≥n de ejemplo escuchando en el puerto 3000!")
);
```

Una vez que inicies la aplicaci√≥n en la l√≠nea de comandos con `npm start`, deber√≠as poder ver esta salida en la l√≠nea de comandos:

```bash
Example app listening on port 3000!
```

Tu servidor Express est√° en funcionamiento üòé. Todo lo que deber√≠a suceder despu√©s de que su aplicaci√≥n Express se haya iniciado entra en una funci√≥n callback. El m√©todo en s√≠ toma otro par√°metro como primer par√°metro, que es el puerto de la aplicaci√≥n en ejecuci√≥n. Es por eso que despu√©s de iniciarlo, la aplicaci√≥n est√° disponible a trav√©s de `http://localhost:3000`. Sin embargo, no deber√≠a haber nada disponible en esta URL cuando la veas en tu navegador. A continuaci√≥n veremos c√≥mo ponerle contenido.

## Rutas en Express.js

En frameworks como Express.js, se pueden crear rutas una vez que se haya creado la instancia de la aplicaci√≥n. Todas las rutas conforman el enrutamiento completo de la aplicaci√≥n. Vamos a configurar una sola ruta:

```javascript
import express from "express";

const app = express();

app.get("/", (req, res) => {
  res.send("¬°Hola Mundo!");
});

app.listen(3000, () =>
  console.log("¬°Aplicaci√≥n de ejemplo escuchando en el puerto 3000!")
);
```

La ruta apunta a la ra√≠z de tu dominio: `http://localhost:3000/` que tambi√©n se puede usar como `http://localhost:3000`. Una vez que guardes el archivo, la aplicaci√≥n deber√≠a reiniciarse autom√°ticamente. Puedes verificarlo en la l√≠nea de comandos. Luego, checa el navegador en `http://localhost:3000` para ver qu√© resultado produce. Deber√≠as ver el "¬°Hola mundo!" Impreso all√≠. Eso es todo para tu primera ruta en Express.js. Aprenderemos m√°s sobre las rutas y c√≥mo interactuar con ellas m√°s adelante.

Esencialmente, cada aplicaci√≥n Express es solo una serie de llamadas de funci√≥n de enrutamiento y middleware. Acabamos de ver el primero, el enrutamiento con una sola ruta para la URL `http://localhost:3000` o la ruta `/`. Puedes extender la aplicaci√≥n con URIs adicionales (por ejemplo, `http://localhost:3000/test`) utilizando las rutas en Express.js (por ejemplo, `/test`) como se muestra anteriormente. ¬°Int√©ntalo t√∫ mism@!

## Middleware en Express.js

Si una aplicaci√≥n de Express consta de enrutamiento y llamadas de funciones de middleware, ¬øqu√© ocurre con las llamadas de funciones de middleware? Hay dos tipos de middleware en Express.js: middleware de nivel de aplicaci√≥n y middleware de nivel de enrutador. Exploremos un middleware de nivel de aplicaci√≥n en esta secci√≥n con un caso de uso limpio y profundicemos en los otros aspectos del middleware de nivel de aplicaci√≥n y de nivel de enrutador m√°s adelante.

Al usar Express.js, las personas a menudo se encuentran con el siguiente error en el navegador cuando acceden a su aplicaci√≥n Express: *"Cross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at http://localhost:3000/. (Reason: CORS header ‚ÄòAccess-Control-Allow-Origin‚Äô missing).‚Äù*. Lo m√°s probable es que ocurra porque estamos accediendo a un dominio desde un dominio exterior. El intercambio de recursos de origen cruzado (CORS) se invent√≥ para proteger las aplicaciones web en un nivel de dominio. La idea: no deber√≠a ser posible acceder a datos de otros dominios. Por ejemplo, una aplicaci√≥n web con el dominio `https://example.com` no deber√≠a poder acceder a otra aplicaci√≥n web con `https://website.com` de forma predeterminada. Se utiliza para restringir el acceso entre aplicaciones web.

Ahora, podemos permitir CORS agregando este encabezado de CORS faltante, porque eventualmente nos encontraremos con este error al implementar una aplicaci√≥n cliente que consume para nuestro servidor Express. Sin embargo, dado que no queremos hacer esto manualmente para cada ruta, podemos usar un middleware de nivel de aplicaci√≥n para agregar el encabezado CORS HTTP a cada solicitud de forma predeterminada. Por lo tanto, podr√≠amos escribir un middleware nosotros mism@s (veremos c√≥mo funciona esto m√°s adelante) o usar una biblioteca de middleware para Express.js que haga el trabajo por nosotros.

```bash
npm install cors
```

A continuaci√≥n, la utilizaremos como un middleware para toda la aplicaci√≥n:

```javascript
import "dotenv/config";
import cors from "cors";
import express from "express";

const app = express();

app.use(cors());

app.get("/", (req, res) => {
  res.send("¬°Hola Mundo!");
});

app.listen(3000, () =>
  console.log("¬°Aplicaci√≥n de ejemplo escuchando en el puerto 3000!")
);
```

La aplicaci√≥n Express puede usar literalmente un middleware, proveniente de una biblioteca externa o creada por uno mismo, para extender todas sus rutas (middleware de nivel de aplicaci√≥n). En este caso, todas las rutas se extienden con encabezados CORS HTTP. Por defecto, todas las rutas son accesibles para todos los dominios ahora. Esto incluye m√°s adelante nuestros dominios de desarrollo de nuestra aplicaci√≥n cliente consumidora tambi√©n. Despu√©s de todo, esto era solo un adelanto en un middleware en Express. Aprenderemos m√°s sobre middleware de nivel de aplicaci√≥n y de enrutador, y c√≥mo escribir un middleware por ti mism@, m√°s adelante.

> Nota ‚ö†Ô∏è : No te preocupes demasiado por la configuraci√≥n de CORS si a√∫n no la has comprendido por completo. Es una de las cosas con las que se enfrentan muchos usuarios de Express por primera vez, tienen que lidiar con la instalaci√≥n de esta biblioteca ordenada y, a menudo, nunca miran hacia atr√°s por qu√© ten√≠an que instalarla y usarla. Si a√∫n no lo entendiste, no te preocupes, pero al momento de implementar tu aplicaci√≥n en producci√≥n, debes configurar una lista blanca de dominios que tengan acceso a tu aplicaci√≥n de servidor Express. La biblioteca CORS ofrece este tipo de configuraci√≥n. T√≥mate un tiempo para investigarla t√∫ mism@.

## Variables de entorno en Express.js

Antes de configurar las variables de entorno para la aplicaci√≥n Node.js, vamos a usar una variable de entorno para configurar el puerto en lugar de codificarlo en el c√≥digo fuente. Si no hay tal archivo, crea un nuevo archivo `.env` en tu proyecto. De lo contrario, use el archivo `.env` que ya est√° all√≠. D√©le un nuevo par de valores clave para definir su puerto:

```javascript
PORT = 3000;
```

Ahora en tu archivo `src/index.js`, importa el paquete de Node que hace que las variables de entorno est√©n disponibles en tu c√≥digo fuente y usa la variable de entorno PORT para iniciar su aplicaci√≥n Express.

```javascript
import "dotenv/config";
import cors from "cors";
import express from "express";

const app = express();

app.use(cors());

app.get("/", (req, res) => {
  res.send("¬°Hola Mundo!");
});

app.listen(process.env.PORT, () =>
  console.log(
    `¬°Aplicaci√≥n de ejemplo escuchando en el puerto ${process.env.PORT}!`
  )
);
```

En lugar de exponer el puerto que se usa en el c√≥digo fuente, lo has almacenado en un lugar m√°s sensible, en tus variables de entorno. Si est√° utilizando Git con algo como GitHub, puede excluir que `.env` no se cargue en el repositorio de GitHub agreg√°ndolo a su archivo `.gitignore`. As√≠ es como los datos sensibles se mantienen alejados de los repositorios p√∫blicos de Git como GitHub. Si implementas tu aplicaci√≥n en producci√≥n con el tiempo, puedes agregar las variables de entorno como un archivo `.env` en el servidor web que sirve a tu aplicaci√≥n.

Checa el [repositorio de GitHub](https://github.com/lavaldi/simple-node-express-server) üëÄ. Nos vemos!

> Este tutorial es la parte 2 de 3 en esta serie.<br />
> Parte 1: [Configuraci√≥n m√≠nima de Node.js con Babel](/node-con-babel)<br />
> Parte 3: [C√≥mo crear un API REST con Express.js y Node.js](/como-crear-api-rest-express-node)
